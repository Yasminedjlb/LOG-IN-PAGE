
CREATE DATABASE IF NOT EXISTS جمعية_العلماء CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
USE جمعية_العلماء;

-- جدول المستخدمين الإداريين
CREATE TABLE IF NOT EXISTS المستخدمين (
    معرف INT AUTO_INCREMENT PRIMARY KEY,
    الاسم_الكامل VARCHAR(100) NOT NULL,
    اسم_المستخدم VARCHAR(50) NOT NULL UNIQUE,
    البريد_الإلكتروني VARCHAR(100) NOT NULL UNIQUE,
    كلمة_المرور VARCHAR(255) NOT NULL,
    رقم_الهاتف VARCHAR(20),
    الدور ENUM('مدير', 'مشرف', 'موظف') NOT NULL,
    الحالة ENUM('نشط', 'غير نشط', 'قيد المراجعة') DEFAULT 'نشط',
    تاريخ_التسجيل TIMESTAMP DEFAULT CURRENT_TIMESTAMP
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

CREATE TABLE IF NOT EXISTS صلاحيات_المستخدم (
    معرف INT AUTO_INCREMENT PRIMARY KEY,
    معرف_المستخدم INT NOT NULL,
    الصلاحية ENUM(
        'إدارة المستخدمين',
        'إدارة الأساتذة',
        'إدارة الطلاب',
        'إدارة الحلقات',
        'الإحصائيات والتقارير'
    ) NOT NULL,
    FOREIGN KEY (معرف_المستخدم) REFERENCES المستخدمين(معرف) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

-- بيانات المستخدمين من واجهة إدارة المستخدمين
INSERT INTO المستخدمين (
    الاسم_الكامل, اسم_المستخدم, البريد_الإلكتروني, كلمة_المرور, رقم_الهاتف, الدور, الحالة, تاريخ_التسجيل
) VALUES
('أحمد علي', 'ahmad_ali', 'ahmed@example.com', 'password123', '0591234567', 'مدير', 'نشط', '2025-01-01'),
('خالد محمود', 'khaled_m', 'khaled@example.com', 'password123', '0597654321', 'مشرف', 'نشط', '2025-02-05'),
('سارة أحمد', 'sara_ahmed', 'sara@example.com', 'password123', '0591111222', 'مشرف', 'غير نشط', '2025-03-10'),
('محمد عمر', 'moh_omar', 'mohamed@example.com', 'password123', '0593333444', 'موظف', 'نشط', '2025-03-15'),
('ليلى مصطفى', 'layla_m', 'layla@example.com', 'password123', '0595555666', 'موظف', 'قيد المراجعة', '2025-03-20'),
('عمر فاروق', 'omar_farouq', 'omar@example.com', 'password123', '0597777888', 'مدير', 'نشط', '2025-03-25'),
('نور الهدى', 'nour_h', 'nour@example.com', 'password123', '0599999000', 'موظف', 'نشط', '2025-03-30');

-- صلاحيات أحمد علي (مدير)
INSERT INTO صلاحيات_المستخدم (معرف_المستخدم, الصلاحية) VALUES
(1, 'إدارة المستخدمين'),
(1, 'إدارة الأساتذة'),
(1, 'إدارة الطلاب'),
(1, 'إدارة الحلقات'),
(1, 'الإحصائيات والتقارير');

-- صلاحيات خالد محمود (مشرف)
INSERT INTO صلاحيات_المستخدم (معرف_المستخدم, الصلاحية) VALUES
(2, 'إدارة المستخدمين'),
(2, 'إدارة الأساتذة'),
(2, 'إدارة الطلاب');

-- صلاحيات سارة أحمد (مشرف)
INSERT INTO صلاحيات_المستخدم (معرف_المستخدم, الصلاحية) VALUES
(3, 'إدارة الطلاب'),
(3, 'إدارة الحلقات');

-- صلاحيات محمد عمر (موظف)
INSERT INTO صلاحيات_المستخدم (معرف_المستخدم, الصلاحية) VALUES
(4, 'إدارة الطلاب');

-- صلاحيات ليلى مصطفى (موظف)
INSERT INTO صلاحيات_المستخدم (معرف_المستخدم, الصلاحية) VALUES
(5, 'إدارة الحلقات');

-- صلاحيات عمر فاروق (مدير)
INSERT INTO صلاحيات_المستخدم (معرف_المستخدم, الصلاحية) VALUES
(6, 'إدارة المستخدمين'),
(6, 'إدارة الأساتذة'),
(6, 'إدارة الطلاب'),
(6, 'إدارة الحلقات'),
(6, 'الإحصائيات والتقارير');

-- صلاحيات نور الهدى (موظف)
INSERT INTO صلاحيات_المستخدم (معرف_المستخدم, الصلاحية) VALUES
(7, 'الإحصائيات والتقارير');